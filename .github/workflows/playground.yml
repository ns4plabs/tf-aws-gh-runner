name: Playground

on:
  workflow_dispatch:
  push:
    paths:
      - .github/workflows/playground.yml

jobs:
  playground:
    name: Play
    runs-on: ["self-hosted", "windows", "x64", "playground"]
    steps:
      - run: |
          ls C:\Program Files\Git\bin
          echo "==="
          $env:path -split ";"
          $currentPath = [Environment]::GetEnvironmentVariable("Path", "Machine")
          $newPath = "C:\Program Files\PowerShell\7;C:\Program Files\Git\bin;$currentPath;"
          [Environment]::SetEnvironmentVariable("Path", $newPath, "Machine")
          echo "==="
          refreshenv
          $env:path -split ";"
      - run: echo "hello"
        shell: bash
      - run: echo "C:\Program Files\Git\usr\bin" >> $GITHUB_PATH
      - run: refreshenv
      - run: $env:path -split ";"
      - run: choco install msys2 powershell-core -y
      - run: refreshenv
      - run: $env:path -split ";"
      - run: ls "C:\Program Files\PowerShell\7"
      - run: ls "C:\tools"
